<%= form_tag ({controller: "comments", action: "create", method: "post"}) do %>
  <%= text_field_tag "content" %>
  <%= hidden_field_tag "user_id", "#{current_user.id}"%>
  <%= hidden_field_tag "book_id", "#{@book.id}"%>
  <input type=submit value='Comment'>
<% end %>

<!-- Problems here: -->
<!-- - Since there are forms for both posting and destroying comments, the script can't define which is which, so both forms get sent to the same script. Cannot get form to add a class or id name, even with research
- The line: ` var posting = $.post('/comments', values)` is aborted, even though the terminal actually does create the new comment every time -->
<script type="text/javascript" charset="utf-8">
  $(function () {
    $('form').submit(function(event) {
      event.preventDefault();
      var values = $(this).serialize();
      var posting = $.post('/comments', values);
      posting.done(function(data) {
        let comment = data['data'];
        let block = document.createElement("div");

        let contentLine = document.createElement("p");
        contentLine.attr('id', "comment-content");
        $("#comment-content").text(comment["attributes"]['content']);

        let usernameLine = document.createElement("p");
        usernameLine.attr("id", "comment-username");
        $("#comment-username").text(comment["attributes"]["user"]);
        let id = parseInt(comment["id"])
        block.attr("data-id", id)
        block.addClass("js-comment")

        $("[data-id=`id`]").append(contentLine)
        $("[data-id=`id`]").append(usernameLine)
        document.body.append(block)
      });
    });
  });
</script>
